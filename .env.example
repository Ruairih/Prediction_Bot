# =============================================================================
# Polymarket Trading Bot - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values.
# NEVER commit .env to version control - it contains secrets!
# =============================================================================

# -----------------------------------------------------------------------------
# DATABASE
# -----------------------------------------------------------------------------
# PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://predict:predict@localhost:5433/predict

# For Docker: use the service name as host
# DATABASE_URL=postgresql://predict:predict@postgres:5432/predict

# -----------------------------------------------------------------------------
# POLYMARKET API CREDENTIALS
# -----------------------------------------------------------------------------
# Path to the JSON file containing Polymarket CLOB API credentials
# Generate these at: https://polymarket.com/
# See polymarket_api_creds.json.example for the expected format
POLYMARKET_CREDS_PATH=./polymarket_api_creds.json

# Alternative: Set credentials directly (not recommended - use JSON file)
# POLYMARKET_API_KEY=your-api-key
# POLYMARKET_API_SECRET=your-api-secret
# POLYMARKET_API_PASSPHRASE=your-passphrase
# POLYMARKET_PRIVATE_KEY=0x...

# Polygon wallet private key (for signing transactions)
# WARNING: This key controls real funds on Polygon mainnet!
PRIVATE_KEY=0x...

# -----------------------------------------------------------------------------
# TELEGRAM ALERTS
# -----------------------------------------------------------------------------
# Bot token from @BotFather
TELEGRAM_BOT_TOKEN=

# Chat ID to send alerts to (use @userinfobot to find your chat ID)
TELEGRAM_CHAT_ID=

# -----------------------------------------------------------------------------
# EXTERNAL APIS
# -----------------------------------------------------------------------------
# Goldsky API key for blockchain data (optional)
GOLDSKY_API_KEY=

# -----------------------------------------------------------------------------
# STRATEGY CONFIGURATION
# -----------------------------------------------------------------------------
# Strategy to use (generic bot - strategies are pluggable)
# Available: high_prob_yes (more can be registered via StrategyRegistry)
STRATEGY_NAME=high_prob_yes

# -----------------------------------------------------------------------------
# TRADING CONFIGURATION
# -----------------------------------------------------------------------------
# Set to "true" to enable paper trading mode (no real orders)
DRY_RUN=true

# Price threshold for triggers (0.95 = 95 cents)
PRICE_THRESHOLD=0.95

# Position size in USDC
POSITION_SIZE=20

# Maximum number of open positions
MAX_POSITIONS=50

# Maximum orderbook deviation from trigger price (G5 protection)
MAX_PRICE_DEVIATION=0.10

# Minimum trade size filter (critical for win rate)
MIN_TRADE_SIZE=50

# Maximum age of trades to consider (seconds) - G1 Belichick bug protection
MAX_TRADE_AGE_SECONDS=300

# -----------------------------------------------------------------------------
# EXIT STRATEGY CONFIGURATION
# -----------------------------------------------------------------------------
# Minimum balance to keep in reserve (never trade below this)
MIN_BALANCE_RESERVE=100

# Profit target for long positions (0.99 = 99 cents)
PROFIT_TARGET=0.99

# Stop loss for long positions (0.90 = 90 cents)
STOP_LOSS=0.90

# Minimum days to hold before applying exit rules (short positions hold to resolution)
MIN_HOLD_DAYS=7

# Watchlist rescore interval (hours) - how often to re-evaluate watchlist entries
WATCHLIST_RESCORE_INTERVAL_HOURS=1.0

# -----------------------------------------------------------------------------
# POSITION SYNC CONFIGURATION
# -----------------------------------------------------------------------------
# Your Polymarket wallet address (required for position sync)
# This enables automatic reconciliation with Polymarket on startup
WALLET_ADDRESS=0x...

# Sync positions on startup (default: true)
# When enabled, the bot verifies local positions match Polymarket state
# Detects: resolved markets, external sales, new external positions
SYNC_POSITIONS_ON_STARTUP=true

# Hold policy for newly imported positions: "new", "mature", or "actual"
# - new: Treat as fresh (7-day hold before exit logic applies)
# - mature: Apply exit logic immediately
# - actual: Use actual trade timestamps (slowest - fetches trade history)
STARTUP_SYNC_HOLD_POLICY=new

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# MONITORING & DASHBOARD (See G11 in docs/reference/known_gotchas.md)
# -----------------------------------------------------------------------------
# Enable/disable dashboard
DASHBOARD_ENABLED=true

# Dashboard host binding
# - 127.0.0.1 = localhost only (secure, but not accessible via Tailscale)
# - 0.0.0.0 = all interfaces (REQUIRED for Docker or Tailscale access)
# WARNING: If using 0.0.0.0, set DASHBOARD_API_KEY for security!
DASHBOARD_HOST=0.0.0.0

# Dashboard port - IMPORTANT: Pick a port FREE on your host machine!
# Common conflicts: 5050 (often in use), 8080 (web servers)
# Recommended: 9050 (high port, usually free)
DASHBOARD_PORT=9050

# Dashboard API key (REQUIRED if DASHBOARD_HOST=0.0.0.0)
# Set this to secure the dashboard when exposed on a network
# Access via header: X-API-Key: your-key
# Or query param: ?api_key=your-key
DASHBOARD_API_KEY=

# Docker port binding host (used in docker-compose.yml)
# - 127.0.0.1 = localhost only (use when Tailscale serve forwards to these ports)
# - 0.0.0.0 = all interfaces (use for direct access without Tailscale)
# NOTE: If Tailscale serve is running, it binds to the Tailscale interface.
#       Docker binding to 0.0.0.0 will conflict. Use 127.0.0.1 instead.
BIND_HOST=0.0.0.0

# Health check interval (seconds)
HEALTH_CHECK_INTERVAL=60

# Alert cooldown (seconds) - prevents spam
ALERT_COOLDOWN_SECONDS=300

# -----------------------------------------------------------------------------
# REDIS (Optional - for caching)
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6380

# -----------------------------------------------------------------------------
# DEVELOPMENT
# -----------------------------------------------------------------------------
# Test database URL (uses different port to avoid conflicts)
TEST_DATABASE_URL=postgresql://predict:predict@localhost:5433/predict

# Enable debug mode (verbose logging, no real trades)
DEBUG=false
